let ThemifyPanel;((d,o,p)=>{'use strict';ThemifyPanel=class{constructor(e,t,a,n,s){this.el=e,this.vals=a,this.options=n,this.labels=s,this.nonce=t,this.bindings=new Map,this.topTabs();const i=new IntersectionObserver(async(t,a)=>{for(let e=t.length-1;-1<e;--e)if(!0===t[e].isIntersecting){a.unobserve(t[e].target);const n=t[e].target,s=p.createElement('div');s.className='tf_loader';try{if(n.classList.contains('ajax_select')){n.parentNode.after(s);const i=d.fetch({action:n.dataset.ajaxAction,nonce:this.nonce},'html');n.firstChild&&n.firstChild.remove(),n.appendChild(i)}else if(n.hasAttribute('data-codeditor')){let e=(await d.importJs(d.url+'js/admin/modules/codemirror/codemirror')).ThemifyCodeMiror,t=new e(n,n.dataset.codeditor);await t.run()}}catch(e){}s.remove()}0===t.length&&a.disconnect()}),l=e.querySelectorAll('.ajax_select,[data-codeditor]');for(let e=l.length-1;-1<e;--e)i.observe(l[e])}getIcon(e,t){e='tf-'+e.trim().replace(' ','-');const a='http://www.w3.org/2000/svg',n=p.createElementNS(a,'use'),s=p.createElementNS(a,'svg');let i='tf_fa '+e;return t&&(i+=' '+t),s.setAttribute('class',i),n.setAttributeNS(null,'href','#'+e),s.appendChild(n),s}after(e){const t=p.createElement('div');return t.innerHTML=e,t.className='after',t}getHelp(e){const t=p.createElement('div'),a=p.createElement('i'),n=p.createElement('div');return a.appendChild(this.getIcon('ti-help')),a.tabIndex='-1',n.className='help_content tf_hide tf_box',n.innerHTML=e,t.className='help tf_rel',t.append(a,n),t}getDisabledMsg(e){const t=p.createElement('div');return'disabled'!==e&&(t.className='warning',t.innerHTML=e),t}binding(){if(0<this.bindings.size)for(let[e,i]of this.bindings){let t=this.el.querySelector('#'+e);if(t){let e=function(){let e={},a=this.closest('#main'),n,s;if('SELECT'===this.tagName?e=i[this.value]||i.any:'checkbox'===this.type&&(e=this.checked?i.checked:i.not_checked),n=e.show,s=e.hide,n)for(let t=(n=Array.isArray(n)?n:[n]).length-1;-1<t;--t){let e=a.querySelector('.'+n[t]);e&&(e.style.display='')}if(s)for(let t=(s=Array.isArray(s)?s:[s]).length-1;-1<t;--t){let e=a.querySelector('.'+s[t]);e&&(e.style.display='none')}};e.call(t),t.tfOn('change',e,{passive:!0})}}this.bindings.clear()}topTabs(){const i=p.createDocumentFragment(),l=p.createDocumentFragment(),r=p.createDocumentFragment(),e=this.el.querySelector('#main'),t=p.createElement('ul');let c=new URL(window.location.href).searchParams.get('tab')||'';this.options[c]===o&&(c=Object.keys(this.options)[0]),t.className='top_tabs tf_overflow';for(let s in this.options){let e=p.createElement('li'),t=p.createElement('section'),a=p.createElement('input'),n=p.createElement('label');a.type='radio',a.name='tab',a.className='tab tf_hide',a.id=n.htmlFor='tab-'+s,n.append(this.getIcon(this.options[s].icon),p.createTextNode(this.options[s].label)),t.id='tab-'+s+'-content',t.className='content tf_hide',s===c&&(a.checked=!0),t.appendChild(this.render(this.options[s].options)),e.appendChild(n),l.appendChild(t),r.appendChild(a),i.appendChild(e)}this.el.tfOn('change',e=>{const t=e.target&&'radio'===e.target.type&&e.target.classList.contains('tab')?e.target:null;if(t){const a=new URL(window.location.href);a.searchParams.set('tab',t.id.replace('tab-','')),history.replaceState(null,null,a)}},{passive:!0}),t.appendChild(i),this.el.prepend(r),this.el.tfClass('header')[0].prepend(t),e.classList.add('tf_opacity'),e.appendChild(l),this.binding(),e.classList.remove('tf_opacity')}render(d){const t=p.createDocumentFragment();for(let c=0,e=d.length;c<e;++c){let s=p.createElement('div'),a=p.createElement('div'),i=d[c].id,l=d[c].type,n=d[c].label!==o,r=i!==o&&this.vals[i]!==o?this.vals[i]:d[c].def;if(s.className='field',a.className='field_input field_'+l,n){let e='checkbox'===l?Object.keys(d[c].options).length:0,t=(i&&'radio'===l&&(i+='_'+Object.keys(d[c].options)[0]),i?'label':'span'),a=p.createElement(t),n='label'==t?p.createElement('div'):null;a.textContent=d[c].label,i&&(a.htmlFor=i),('group'===l||'radio'===l||1<e)&&(s.className+=' alig_top'),n&&(n.className='label',n.appendChild(a),a=n),d[c].help&&(a.appendChild(this.getHelp(d[c].help)),n||(a.className='label')),s.appendChild(a)}try{let e='text'===l||'number'===l||'email'===l||'url'===l||'hidden'===l?'input':l,t=this[e](d[c],r,l);n||'group'!==l?a.appendChild(t):(s.className+=' field_group',s.appendChild(t))}catch(e){console.log(l,e)}if(n||'group'!==l){if(!d[c].disabled&&d[c].desc){s.classList.add('alig_top');let e=p.createElement('div');e.className='description',e.innerHTML=d[c].desc,a.appendChild(e)}s.appendChild(a)}d[c].disabled&&(s.classList.add('alig_top','has_error'),a.appendChild(this.getDisabledMsg(d[c].disabled))),a.className+=' count_'+a.childElementCount,d[c].wrap_class&&(s.className+=' '+d[c].wrap_class),s.className+=' count_'+s.childElementCount,t.appendChild(s),d[c].bind&&i&&this.bindings.set(i,d[c].bind)}return t}select(a,n){const e=p.createElement('div'),t=p.createElement('select'),s=p.createDocumentFragment(),i=p.createDocumentFragment();if(e.className='selectwrapper tf_inline_b tf_vmiddle tf_rel',t.className='tf_scrollbar',a.class!==o&&(t.className+=' '+a.class),a.id&&(t.name=t.id=a.id),a.disabled?t.disabled=!0:n&&a.ajax&&(a.options={[n]:''}),a.options){for(let t in a.options){let e=p.createElement('option');e.value=t,e.text=a.options[t],t===n&&(e.selected=!0),i.appendChild(e)}t.appendChild(i)}return e.appendChild(t),s.appendChild(e),a.after&&s.appendChild(this.after(a.after)),a.ajax&&(t.className+=' ajax_select',t.dataset.ajaxAction=a.ajax),s}expand(e){const t=p.createElement('div');return t.className='expand',t.appendChild(this.render(e.options)),t}group(e){return this.render(e.options)}radio(n,s){const i=p.createDocumentFragment(),l=n.options;for(let a in l){let e=p.createElement('input'),t=p.createElement('label');e.type='radio',e.value=a,e.name=n.id,t.textContent=l[a],t.htmlFor=e.id=n.id+'_'+a,n.disabled?e.disabled=!0:a===s&&(e.checked=!0),i.append(e,t)}return n.after&&f.appendChild(this.after(n.after)),i}checkbox(n,s){const i=p.createDocumentFragment(),l=n.options;for(let a in l){let e=p.createElement('input'),t=p.createElement('label');e.type='checkbox',e.value=1,e.name=a,t.textContent=l[a],t.htmlFor=e.id=a+'_checkbox',n.disabled?e.disabled=!0:a===s&&(e.checked=!0),i.appendChild(e),l[a]&&i.appendChild(t)}return n.after&&i.appendChild(this.after(n.after)),i}input(e,t,a){const n=p.createDocumentFragment(),s=p.createElement('input');return e.disabled?s.disabled=!0:s.value=null!=t?t:'',s.type=a||'text',e.id&&(s.name=e.id),'hidden'!==a&&(e.id&&(s.id=e.id),e.min||'number'===a||'range'===a?s.min=parseInt(e.min)||0:s.className='tf_w',e.max&&(s.max=parseInt(e.max),s.defaultValue=s.value=t),e.step&&(s.step=e.step),e.placeholder&&(s.placeholder=e.placeholder)),e.class&&(s.className+=' '+e.class),n.appendChild(s),e.after&&n.appendChild(this.after(e.after)),n}textarea(e,t){const a=p.createDocumentFragment(),n=p.createElement('textarea');return n.id=n.name=e.id,n.className='tf_w',e.class&&(n.className+=' '+e.class),e.disabled?n.disabled=!0:n.value=t||'',a.appendChild(n),e.after&&a.appendChild(this.after(e.after)),e.codeditor&&(n.dataset.codeditor=e.codeditor),a}slider(e,t){const a=p.createDocumentFragment(),n=Object.assign(e),s=(t||e.def||(t=e.max),delete n.after,this.input(n,t,'number')),i=(delete n.id,this.input(n,t,'range'));a.append(i,s),e.after&&a.appendChild(this.after(e.after));for(let e=a.querySelectorAll('input'),t=e.length-1;-1<t;--t)e[t].tfOn('input change',e=>{let t=e.currentTarget,a=parseInt(t.value),n=parseInt(t.min),s=parseInt(t.max),i=t.nextElementSibling||t.previousElementSibling;'change'===e.type&&(a>s||a<n)&&(a=a>s?s:n,t.value=a),i.value=a},{passive:!0});return a}toggle(e,t){const a=p.createElement('label'),n=p.createElement('input'),s=p.createElement('div'),i=e.value||1;return n.className='toggle_switch',n.type='checkbox',n.id=n.name=e.id,n.value=i,e.disabled?n.disabled=!0:(e.opp&&(n.className+=' opposite'),t==i&&(n.checked=!0)),s.className='switch_label tf_rel tf_box',s.dataset.on=e.show||this.labels.en,s.dataset.off=e.hide||this.labels.dis,e.class&&(s.className+=' '+e.class),a.append(n,s),a}replace_url(e,t){const a=p.createDocumentFragment(),n=this.render([e.find]),s=this.render([e.replace]),i=p.createElement('button'),l=p.createElement('span'),c=e.confirm;return l.textContent=e.text,i.type='button',i.className='clear_cache find_replace',e.class&&(i.className+=' '+e.class),i.dataset.done=e.done,i.dataset.clearing=e.clearing,i.append(this.getIcon('ti-eraser'),l),i.tfOn('click',async e=>{if(confirm(c)){const t=e.currentTarget;if(!t.disabled){t.disabled=!0,d.importJs(d.url+'js/admin/notification');const a=t.tfTag('span')[0],n=a.textContent,s=(a.textContent=t.dataset.clearing,(await d.importJs(d.url+'js/admin/modules/find-replace')).Replace),i=t.closest('.field_replace_url').tfTag('input'),l=i[0].value.trim(),r=i[1].value.trim();try{await s(l,r,this.nonce)}catch(e){}a.textContent=n,t.disabled=!1}}},{passive:!0}),a.append(n,s,i),a}clear_cache(e,t){const a=p.createDocumentFragment(),r=p.createElement('button'),n=p.createElement('span');if(n.textContent=e.text,r.className='clear_cache',r.type='button',e.class&&(r.className+=' '+e.class),r.dataset.action=e.action,r.dataset.done=e.done,r.dataset.clearing=e.clearing,r.append(this.getIcon('ti-eraser'),n),a.appendChild(r),e.network){const s=p.createElement('div');s.className='clear_cache_network',s.appendChild(this.checkbox({options:e.network})),a.appendChild(s)}return e.after&&a.appendChild(this.after(e.after)),r.tfOn('click',async e=>{const t=e.currentTarget,a=t.tfTag('span')[0],n=a.textContent;if(!t.disabled){a.textContent=t.dataset.clearing,t.disabled=!0;const s=(await d.importJs(d.url+'js/admin/notification')).Notification;s.show('info',t.dataset.clearing);try{const i=await d.fetch({nonce:this.nonce,action:t.dataset.action,all:r.parentNode.querySelector('input:checked')?1:0});if(!i.success)throw i;await s.showHide('done',t.dataset.done,1500)}catch(e){const l=e.data||e;await s.showHide('error',l)}a.textContent=n,t.disabled=!1}},{passive:!0}),a}}})(Themify,void 0,document);export{ThemifyPanel};