((N,F,d)=>{'use strict';N.Drop={row(n,c,l){return new Promise((t,a)=>{const e=l=>{const s=d.createDocumentFragment(),r=[],i=[],e=()=>{const e=()=>{'grid'!==c&&'pagebreak'!==c&&N.Spinner.showLoader('done'),t()};'pagebreak'!==c?N.correctColumnPaddings().then(()=>{N.breakpointsReverse,N.Builder.get().el;for(let e=0,t=r.length;e<t;++e)N.Utils.setCompactMode(r[e].el.tfClass('module_column')),N.Utils.runJs(r[e].el),r[e].el.style.visibility='';e()}):(N.pageBreakModule.countModules(),e())},o=null===n.closest('.tb_holder');for(let t=0,e=l.length;t<e;++t){let e=new(1==o?N.Row:N.Subrow)(l[t]);if(s.appendChild(e.el),console.log(e,l),r.push(e),'visual'===N.mode&&'grid'!==c){let t=e.el.querySelectorAll('[data-cid]');i.push(e.id);for(let e=t.length-1;-1<e;--e)i.push(t[e].dataset.cid);e.el.style.visibility='hidden'}}n.replaceWith(s),N.Builder.get().removeLayoutButton(),'visual'===N.mode?N.bootstrap(i).then(e).catch(a):e()};N.Utils.scrollTo(n),'library'===c?this.Library.row(l).then(e).catch(a):'predesign'===c?N.preDesignedRows.get(l).then(e).catch(a):'pagebreak'===c?e(N.pageBreakModule.get()):'grid'===c?e(N.Utils.grid(l)):a()})},column(U,I,R){return new Promise(e=>{const r=U.parentNode,l=!I,s=!r,a=1==s?null:N.Registry.get(r.closest('[data-cid]').dataset.cid),i=I?I.parentNode:r,g=N.Registry.get(i.closest('[data-cid]').dataset.cid),n=g.get('sizes'),c=a?a.get('sizes'):{},t=(c.desktop_area&&ThemifyStyles.normalizeArea(c.desktop_area),'left'!==R&&I?I.nextElementSibling:I),u=getComputedStyle(U).getPropertyValue('grid-area').split('/')[0].replace('"','').trim();if(r!==i){i.insertBefore(U,t);const o=i.classList.contains('subrow_inner');if(U.classList.toggle('sub_column',o),U.classList.toggle('tb-column',!o),r&&!r.firstChild){const C=new N.Column({grid_class:'col-full'},r.classList.contains('subrow_inner'));r.appendChild(C.el)}}else 1==l&&U.remove();const f=N.activeBreakPoint,d=i.childElementCount,p=r?r.childElementCount:0,m=getComputedStyle(i),h=N.breakpointsReverse,j=0==l&&I?getComputedStyle(I).getPropertyValue('grid-area').split('/')[0].replaceAll('"','').trim():null,y=e=>{if(-1===e.indexOf(' '))return m.getPropertyValue('--c'+e);if(-1!==(e=e.replace(/\s\s+/g,' ').trim()).indexOf('repeat')){if(-1!==e.indexOf('auto-fit')||-1!==e.indexOf('auto-fill'))return'';{let r='',i=e.replace(/\s\,\s|\s\,|\,\s/g,',').replace(/\s\(\s|\s\(|\(\s/g,'(').replaceAll(' )',')').trim().split(' ');for(let s=0,e=i.length;s<e;++s)if(-1!==i[s].indexOf('repeat')){let e=i[s].split('(')[1].replace(')','').split(','),t=parseInt(e[0]),l=e[1].trim();isNaN(t)&&(l='1fr',t=childCount),r+=' '+(' '+l).repeat(t)}else r+=' '+i[s];e=r.trim()}}return e},_=(e,l)=>{const s=l.length,t=N.getColClass(),r=N.getColClassValues(),i=e&&-1===e.indexOf(' ')&&void 0!==t[e]?t[e]:t[s],o=r.length-1;for(let e=s-1;-1<e;--e){let t=l[e].classList;for(let e=o;-1<e;--e)t.remove(r[e]);void 0!==i&&s<7&&t.add(i[e]),t.remove('first','last')}1<s&&(l[0].classList.add('first'),l[s-1].classList.add('last'))};if(r===i&&0==l&&0==s)if('desktop'===f){const b={},z={},w=m.getPropertyValue('--area').replaceAll('"','').trim().split(' '),v=r.children,x=v.length;r.classList.remove('direction_rtl'),a.setSizes({dir:''});for(let t=x-1;-1<t;--t){let e=v[t].dataset.cid;e&&(b[e]=t+1)}let e=m.getPropertyValue('--col');if(r.insertBefore(U,t),e&&'unset'!==e&&'initial'!==e&&'none'!==e&&-1===e.indexOf('repeat')){const L=w.indexOf(u),S=getComputedStyle(U).getPropertyValue('grid-area').split('/')[0].replaceAll('"','').trim(),O=w.indexOf(S),P=(e=e.split(' '))[O];e[O]=e[L],e[L]=P,a.setCols({size:e.join(' ')},f)}for(let t=x-1;-1<t;--t){let e=v[t].dataset.cid;e&&(z[e]=t+1)}for(let l=h.length-2;-1<l;--l){let e=h[l],t=c[e+'_area'];if(t){-1===t.indexOf('"')&&(t=m.getPropertyValue('--area'+t).replace(/\s\s+/g,' ').trim());for(let e in z)b[e]!==z[e]&&(t=t.replaceAll(b[e]+' ','#'+z[e]+'# ').replaceAll(b[e]+'"','#'+z[e]+'#"'));a.setCols({area:t.replaceAll('#','')},e)}}_(e,v)}else{let r=m.getPropertyValue('--area').replace(/  +/g,' ').trim(),l=m.getPropertyValue('--col'),e='right'===R?1:0,t='left',s,i=r.split('" "')[0].split(' ').length,o=(r=r.replaceAll('"','').trim().split(' ')).indexOf(j),a=r.indexOf(u),n=a,c=F.convert(r),d=r.length,p=[];if(n<o&&(t='right',e='right'===R?0:-1,n=r.lastIndexOf(u)),o+=e,s=r[o],'left'===t)for(let s=n-1;s>=o;--s){let t=r[s],l=r[s+1];if(t!==l)for(let e=s;e<d;++e)r[e]===l&&(r[e]='_'+t)}else for(let s=n+1;s<=o;++s){let t=r[s],l=r[s-1];if(t!==l)for(let e=0;e<s;++e)r[e]===l&&(r[e]='_'+t)}for(let e=d-1;-1<e;--e)'_'===r[e][0]?r[e]=r[e].substring(1):s===r[e]&&(r[e]=u);for(let e=0,t=d/i;e<t;++e)p.push('"'+r.slice(e*i,(e+1)*i).join(' ')+'"');const k={area:p=p.join(' ')};if(l&&'unset'!==l&&'initial'!==l&&'none'!==l){const A=parseInt(a/i),B=p.replaceAll('"','').trim().split(' ').indexOf(u),G=parseInt(B/i);if(G===A&&(l=y(l))){l=l.split(' ');const V=[],M=p.split('" "')[A].replaceAll('"','').split(' ');c=c.slice(A*i,A*i+i);for(let t=0,e=M.length;t<e;++t){let e=c.indexOf(M[t]);V[t]=l[e],c.slice(e,1)}k.size=V.join(' ')}}g.setCols(k,f)}else{let o='1fr';if(0==s){let e={},t={},l=[],i=c.desktop_size,s=parseInt(u.replace('col',''));for(let e=1;e<=p+1;++e)l[e-1]=e;i=i&&'1'!==i&&1!==i?(i=y(i))&&i.split(' '):null;for(let t=l.length-1;-1<t;--t){let e=parseInt(l[t]);e===s?(i&&void 0!==i[t]&&(o=i[t],i.splice(t,1)),l.splice(t,1)):(e>s&&--e,l[t]='col'+e)}if(o&&'1fr'!==o){let s=parseFloat(o),r=0;if(.1<s-1){for(let t=i.length-1;-1<t;--t){let e=parseFloat(i[t]);(1<s&&e<1||s<1&&1<e)&&++r}if(0<r){let l=parseFloat(s/r);s<1&&(l*=-1);for(let t=i.length-1;-1<t;--t){let e=parseFloat(i[t]);(1<s&&e<1||s<1&&1<e)&&(i[t]=e+l+'fr')}}}}_(i=1!==p&&i?ThemifyStyles.getColSize(i.join(' '),!1):null,r.children),1===p?(l=null,t.gutter=e['--area']=e['--colG']=''):l='"'+l.join(' ')+'"',t.area=l,t.size=i,a.setCols(t),i||(e['--col']=''),a.setGridCss(e),r.classList.remove('tb_col_count_'+(p+1)),r.classList.add('tb_col_count_'+p)}if(0==l){let t=[],e={},l=n.desktop_size;for(let e=1;e<d+1;++e)t[e-1]='col'+e;if(l=l||'1fr'===o?l:'1fr '.repeat(d).trim())if(l=y(l)){l=l.split(' ');let e=F.convert(i.children).indexOf(U);l.splice(e,0,o),l=ThemifyStyles.getColSize(l.join(' '),!1)}else l=null;l||(e['--col']=''),_(l,i.children),t='"'+t.join(' ')+'"',g.setCols({area:t,size:l}),g.setGridCss(e),i.classList.remove('tb_col_count_'+(d-1)),i.classList.add('tb_col_count_'+d),g.setMaxGutter()}const T=new Set;for(let e=h.length-2;-1<e;--e){let t=h[e];if(0==s){let e=a.getGridCss({size:'auto'},t);'auto'!==a.getSizes('size',t)&&T.add(N.Helper.getBreakpointName(t)),e['--area']&&-1===e['--area'].indexOf(' ')?a.setCols({size:'auto'},t):(a.setGridCss({'--area':'','--col':''},t),a.setSizes({size:'auto'},t))}if(0==l){'auto'!==g.getSizes('size',t)&&T.add(N.Helper.getBreakpointName(t));let e=g.getGridCss({size:'auto'},t);e['--area']&&-1===e['--area'].indexOf(' ')?g.setCols({size:'auto'},t):(g.setGridCss({'--area':'','--col':''},t),g.setSizes({size:'auto'},t)),g.setMaxGutter()}}T.size}N.Utils._onResize(!0),e()})},module(i,o,a){return new Promise((e,t)=>{if(N.Utils.scrollTo(i),'part'===o||'module'===o)this.Library.module(i,o,a).then(()=>{e()}).catch(t);else{const l=N.Module.getDefault(a),s=new N.Module({mod_settings:l,mod_name:a}),r=()=>{e(s)};s.is_new=!0,i.replaceWith(s.el),s.trigger('edit'),'layout-part'!==a&&'overlay-content'!==a&&'visual'===N.mode?s.trigger(s.getPreviewType(),l).then(r):r()}})},Library:{row(t){return new Promise((l,e)=>{N.Library.get(t,'row').then(e=>{if(!Array.isArray(e)){e=new Array(e);const t=N.GS.findUsedItems(e);!1!==t&&t.length&&(e[0].used_gs=t)}l(e)}).catch(e)})},module(r,e,t){return new Promise((l,s)=>{N.Library.get(t,e).then(e=>{const t=new N.Module(e);N.bootstrap([t.id]).then(()=>{const e=t.get('mod_settings');r.replaceWith(t.el),t.is_new=!0,t.trigger('edit'),t.trigger(t.getPreviewType(),e).then(()=>{N.Utils.scrollTo(t.el),N.Builder.get().removeLayoutButton(),l(t)})}).catch(s)}).catch(s)})}}}})(tb_app,Themify,document);