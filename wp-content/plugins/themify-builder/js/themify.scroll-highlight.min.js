(($,s,e,o)=>{'use strict';let c=!1,n=null,t=!0,h=!1,l=!1,r=null;const u=Object.assign({speed:0,element:'module_row',offset:null,navigation:'#main-nav,.module-menu .nav',updateHash:!0},tbLocalScript.scrollHighlight),f=parseInt(u.offset),d=e.top.Themify?e.top:e,g=o.tfId('headerwrap'),p=null!==g&&o.body.classList.contains('fixed-header-enabled')||0<f,i={init(e){if(!1===h){const l=d.location.hash.replace('#','');if(l&&'#'!==l){let t=b(o.querySelectorAll('.'+u.element+'[data-anchor="'+l+'"]'));if(!t){let e=o.querySelector('.module [data-id="'+l+'"]');e&&(t=e.closest('.module'))}t&&this.scrollTo(t,l)}h=!0}this.createObserver(e)},changeHash(){if(!1===c){const n=d.location.hash.replace('#',''),a=o.querySelectorAll(u.navigation);for(let e=a.length-1;-1<e;--e){let l=a[e].tfClass('current-menu-item');for(let e=l.length-1;-1<e;--e)null===r&&(r=l[e].tfTag('a')[0].getAttribute('href')),l[e].classList.remove('current_page_item','current-menu-item');for(let t=(l=(l=''!==n&&'#'!==n?a[e].querySelectorAll('a[href*="#'+n+'"]'):null)&&0!==l.length?l:a[e].querySelectorAll('a[href="'+r+'"]')).length-1;-1<t;--t){let e=l[t].parentNode;e.classList.add('current-menu-item'),e.classList.contains('menu-item-object-page')&&e.classList.add('current_page_item')}}null===r&&(r=d.location.href.split('#')[0])}},calculatePosition(e){let t=$(e).offset().top+2;if(!0===p)if(f)t-=f-2;else if(g.classList.contains('fixed-header')){const l=g.getBoundingClientRect().bottom+2;t>=l&&(t-=l)}return t},scrollTo(r,i){c=!0,s.lazyScroll(s.convert(s.selectWithParent('[data-lazy]',r)).reverse(),!0).finally(()=>{const e=s.lazyScrolling,a=!1===h,t=()=>{const t=m(),l=o.tfClass(u.element),n=new IntersectionObserver((t,e)=>{for(let e=t.length-1;-1<e;--e)!0===t[e].isIntersecting&&s.lazyScroll(s.convert(s.selectWithParent('[data-lazy]',t[e].target)).reverse(),!0);e.disconnect()},{rootMargin:'300px 0px 300px 0px',threshold:.01});for(let e=l.length-1;-1<e;--e)l[e].hasAttribute('data-lazy')&&!l[e].classList.contains('hide-'+t)&&n.observe(l[e]);!0===p&&(f||g.classList.contains('fixed-header'))&&s.scrollTo(this.calculatePosition(r),u.speed),s.lazyScrolling=e,(c=!1)==a&&(i=r.hasAttribute('data-hide-anchor')?'':'#'+i.replace('#',''),d.history.replaceState(null,null,i)),y()},l=!0!==p||!f&&g.classList.contains('fixed-header')?null:()=>{(f||g.classList.contains('fixed-header'))&&s.scrollTo(this.calculatePosition(r),u.speed,t)};s.lazyScrolling=!0,s.scrollTo(this.calculatePosition(r),u.speed,t,l),o.activeElement.blur()})},createObserver(e){if(u.updateHash){null===n&&(n=new IntersectionObserver((n,e)=>{if(!1===c){let l=!1;for(let e=0,t=n.length;e<t;++e)!0===n[e].isIntersecting&&(l=n[e].target.dataset.anchor);!1===l?!1===t?(d.history.replaceState(null,null,' '),y()):t=!1:(d.history.replaceState(null,null,'#'+l),y())}},{rootMargin:'0px 0px -100%',thresholds:[0,1]}));const l=s.selectWithParent(u.element,e);for(let t=l.length-1;-1<t;--t)if(!l[t].hasAttribute('data-hide-anchor')){let e=l[t].dataset.anchor;e&&'#'!==e&&n.observe(l[t])}}}},m=()=>{const t=s.w,l=tbLocalScript.breakpoints;for(let e in l)if(Array.isArray(l[e])){if(t>=l[e][0]&&t<=l[e][1])return e}else if(t<=l[e])return e;return'desktop'},b=l=>{if(!l[1])return l[0]||null;let n=m();for(let e=0,t=l.length;e<t;++e)if(!l[e].classList.contains('hide-'+n))return l[e];return null},y=()=>{i.changeHash()};s.on('tb_scroll_highlight_enable',()=>{!1===l&&(l=!0,d.tfOn('hashchange',y,{passive:!0}),s.body.on('click.tb_scroll_highlight','[href*="#"]',function(e){let t=this.getAttribute('href');if(''!==t&&null!==t&&'#'!==t){const l=new URL(t,d.location);if(l.hostname===d.location.hostname&&l.hash&&l.pathname===d.location.pathname){const n=l.hash;if(''!==n&&'#'!==n){const a=b(o.querySelectorAll('.'+u.element+'[data-anchor="'+n.replace('#','')+'"]'));(a||b(o.querySelectorAll(n+'.module,'+n+'.module_row')))&&(s.trigger('tf_side_menu_hide_all'),a&&(e.preventDefault(),e.stopPropagation(),i.scrollTo(a,n)))}}}}))}).on('tb_scroll_highlight_disable',()=>{n&&(n.disconnect(),n=null),l=!1,d.tfOff('hashchange',y,{passive:!0}),s.body.off('click.tb_scroll_highlight')}).on('tb_init_scroll_highlight',e=>{i.init(e),s.trigger('tb_scroll_highlight_enable')})})(jQuery,Themify,window,document);